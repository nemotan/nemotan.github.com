---
layout: post
title: hiev【五】hive综合案例之日志分析
categories:
- hive
tags:
- hive
---
##hadoop
hadoop作业提交shell：
	
	hadoop jar $home/03ws/sp_intel/out/artifacts/hadoop_behavior_jar/hadoop_behavior.jar com.landray.behavior.job.JobManager
##hive
hive常用ddl：
	
	show tables #显示所有的表
	desc table_name #查询表结构
	show partitions request_log; #显示分区信息
	select url['server'] from request_log where dt='1797'; #查询map结构
	 
hive创建外部表：
	
	CREATE EXTERNAL TABLE IF NOT EXISTS request_log(
	file_date STRING,
	id STRING,
	job_create BIGINT,
	node STRING,
	session_id STRING,
	time BIGINT,
	ip STRING,
	user_id STRING,
	name STRING,
	ua INT,
	browser STRING,
	browser_ver STRING,
	log_type STRING,
	dt BIGINT,
	url MAP<STRING,STRING>,
	ref MAP<STRING,STRING>)
	PARTITIONED BY (month STRING,day STRING)
	ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
	COLLECTION ITEMS TERMINATED BY ','
	MAP KEYS TERMINATED BY '::'
	LOCATION '/output/logs/request_transform/';
增加分区：

	_month='2015-09'
	_date='2015-09-07'
	hive -e "ALTER TABLE request_log ADD PARTITION(month='${_month}',day='${_date}') LOCATION '/output/logs/request_tra
	nsform/${_month}/${_date}';"